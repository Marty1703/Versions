{
    "version": "1.12.2",
    "description": "Scalable datastore for metrics, events, and real-time analytics.",
    "homepage": "https://www.influxdata.com/",
    "license": "MIT",
    "architecture": {
        "64bit": {
            "url": "https://download.influxdata.com/influxdb/releases/v1.12.2/influxdb-1.12.2-windows.zip",
            "hash": "bd2bd7a7c1a9aee521a814448b292bb2be1cab2b49dbff069abc70f4920de28a"
        }
    },
    "persist": "influxdb.conf",
    "bin": [
        "influx.exe",
        "influx_inspect.exe",
        "influxd.exe"
    ],
    "checkver": {
        "script": [
            " $repo = \"influxdata/influxdb\" ",
            " $perPage = 100 ",
            " $pageNumber = 1 ",
            " $regexp = \"\"",
            " $found = $false ",
            " $latestV1 = [Version]::new(0,0,0,0) ",
            " $auth = Get-GitHubToken",
            " $head = @{}",
            "if($auth) { $head.add('authorization', \"Bearer $auth\") }",
            " while (-not $found) { ",
            "     $url = \"https://api.github.com/repos/$repo/tags?per_page=$perPage&page=$pageNumber\" ",
            "     Write-Host \"Fetching: $url\" ",

            "     $response = Invoke-RestMethod -Uri $url -Headers $head ",

            "     if ($response.Count -eq 0) { ",
            "         break  # No more tags ",
            "     } ",

            "     foreach ($tag in $response) { ",
            "         if ($tag.name -match \"^v(1\\.\\d+\\.\\d+)$\") { ",
            "             $latestV1 = [Version]::new($matches[1]) ",
            "             $found = $true ",
            "             break ",
            "         } ",
            "     } ",

            "     $pageNumber++ ",
            " } ",

            " if ($found) { ",
            "     Write-Output $latestV1",
            " } else { ",
            "     Write-Host { error \"No v1.x.x release found.\"; }",
            " } "
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://download.influxdata.com/influxdb/releases/v$version/influxdb-$version-windows.zip"
            }
        }
    }
}
